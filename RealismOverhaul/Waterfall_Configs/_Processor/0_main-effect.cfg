@PART[*]:HAS[@ROWaterfall]:FOR[zzzROWaterfall_0_MainEffect]
{
    @description ^= :$: Plume configured by Waterfall-RO.:

    !EFFECTS,* {}

    MODULE
    {
        __ro_waterfall_main = true
        name = ModuleWaterfallFX
        moduleID = #$/name$
        CONTROLLER
        {
            name = atmosphereDepth
            linkedTo = atmosphere_density
        }
        CONTROLLER
        {
            name = throttle
            linkedTo = throttle
        }
        CONTROLLER
        {
            name = random
            linkedTo = random
            range = 0,1
        }
        TEMPLATE
        {
            templateName = #$/ROWaterfall/template$
            overrideParentTransform = #$/ROWaterfall/transform$
            position = #$/ROWaterfall/position$
            rotation = #$/ROWaterfall/rotation$
            scale = #$/ROWaterfall/scale$
        }
    }
}

@PART[*]:HAS[@ROWaterfall:HAS[#engineID]]:FOR[zzzROWaterfall_0_MainEffect]
{
    @MODULE[ModuleWaterfallFX]:HAS[#__ro_waterfall_main]
    {
        engineID = #$/ROWaterfall/engineID$
    }
}

@PART[*]:HAS[@ROWaterfall:HAS[#template[waterfall-ntr-lh2-1]]]:AFTER[zzzROWaterfall_0_MainEffect]
{
    @MODULE[ModuleWaterfallFX]:HAS[#__ro_waterfall_main]
    {
        !CONTROLLER[random] {}
    }
}

@PART[*]:HAS[@ROWaterfall:HAS[#template[waterfall-rcs-jet-1]]]:AFTER[zzzROWaterfall_0_MainEffect]
{
    @MODULE[ModuleWaterfallFX]:HAS[#__ro_waterfall_main]
    {
        !CONTROLLER,* {}
        CONTROLLER
        {
            name = atmosphereDepth
            linkedTo = atmosphere_density
        }
        CONTROLLER
        {
            name = rcs
            linkedTo = rcs
        }
    }
}
